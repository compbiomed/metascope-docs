<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This is the main MetaScope target library mapping function, using Rsubread
and multiple libraries. Aligns to each library separately, filters
unmapped reads from each file, and then merges and sorts the .bam files
from each library into one output file. If desired, output can be
passed to `filter_host()` to remove reads that also map to filter library
genomes."><title>Align microbiome reads to a set of reference libraries — align_target • MetaScope</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Align microbiome reads to a set of reference libraries — align_target"><meta property="og:description" content="This is the main MetaScope target library mapping function, using Rsubread
and multiple libraries. Aligns to each library separately, filters
unmapped reads from each file, and then merges and sorts the .bam files
from each library into one output file. If desired, output can be
passed to `filter_host()` to remove reads that also map to filter library
genomes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MetaScope</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.99</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/MetaScope_vignette.html">Tutorial</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Package News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/compbiomed/MetaScope">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Align microbiome reads to a set of reference libraries</h1>
      <small class="dont-index">Source: <a href="https://github.com/compbiomed/MetaScope/blob/HEAD/R/align_target.R" class="external-link"><code>R/align_target.R</code></a></small>
      <div class="d-none name"><code>align_target.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is the main MetaScope target library mapping function, using Rsubread
and multiple libraries. Aligns to each library separately, filters
unmapped reads from each file, and then merges and sorts the .bam files
from each library into one output file. If desired, output can be
passed to `filter_host()` to remove reads that also map to filter library
genomes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">align_target</span><span class="op">(</span>
  <span class="va">reads</span>,
  <span class="va">libs</span>,
  lib_dir <span class="op">=</span> <span class="cn">NULL</span>,
  project_name <span class="op">=</span> <span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/fileutils.html" class="external-link">file_path_sans_ext</a></span><span class="op">(</span><span class="va">reads</span><span class="op">)</span>,
  settings <span class="op">=</span> <span class="va">align_details</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>reads</dt>
<dd><p>Location of the .fastq file to align</p></dd>
<dt>libs</dt>
<dd><p>A vector of character strings giving the basenames of the
Subread index files for alignment. These should be located in the same
directory and the current directory if lib_dir=NULL.</p></dd>
<dt>lib_dir</dt>
<dd><p>path to the library index files (all libraries should be here)</p></dd>
<dt>project_name</dt>
<dd><p>A name for the project, which names the output .bam
file (e.g. project_name.bam). Defaults to the basename of the reads file.</p></dd>
<dt>settings</dt>
<dd><p>A named <code>list</code> specifying alignment parameters for
the <code><a href="https://rdrr.io/pkg/Rsubread/man/align.html" class="external-link">Rsubread::align()</a></code> function, which is
called inside <code>align_target()</code>.
Elements should include type, nthreads, maxMismatches, nsubreads,
phredOffset, unique, and nBestLocations. Descriptions of these parameters
are available under <code><a href="https://rdrr.io/pkg/Rsubread/man/align.html" class="external-link">?Rsubread::align</a></code>. Defaults to the global
<code>align_details</code> object.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function writes a merged and sorted .bam file after aligning to all
reference libraries given, along with a summary report file, to the user's
working directory.
The function also outputs the new .bam filename.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#### Align example reads to an example reference library using Rsubread</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Create object with path to example reference library</span></span>
<span class="r-in"><span class="va">refPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"target.fasta"</span>, package <span class="op">=</span> <span class="st">"MetaScope"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Copy the example reference library to the current directory</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">refPath</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"."</span>, <span class="st">"target.fasta"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Make and align to a single reference library</span></span>
<span class="r-in"><span class="fu"><a href="mk_subread_index.html">mk_subread_index</a></span><span class="op">(</span><span class="st">"target.fasta"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Library size is 0 GBs. Building the Rsubread index"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========     _____ _    _ ____  _____  ______          _____  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         =====         / ____| |  | |  _ \|  __ \|  ____|   /\   |  __ \ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           =====      | (___ | |  | | |_) | |__) | |__     /  \  | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ====      \___ \| |  | |  _ &lt;|  _  /|  __|   / /\ \ | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               ====    ____) | |__| | |_) | | \ \| |____ / ____ \| |__| |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========   |_____/ \____/|____/|_|  \_\______/_/    \_\_____/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Rsubread 2.8.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= setting ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                Index name : target                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Index space : base space                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Index split : no-split                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||          Repeat threshold : 100 repeats                                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||              Gapped index : no                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||       Free / total memory : 318.3GB / 376.4GB                              ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Input files : 1 file in total                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                             o target.fasta                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= Running ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the integrity of provided reference sequences ...                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || No format issues were found                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Scan uninformative subreads in reference sequences ...                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || 45 uninformative subreads were found.                                      ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || These subreads were excluded from index building.                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Estimate the index size...                                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||    8%,   0 mins elapsed, rate=4059.9k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   16%,   0 mins elapsed, rate=4996.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   24%,   0 mins elapsed, rate=5400.2k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   33%,   0 mins elapsed, rate=5220.0k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   41%,   0 mins elapsed, rate=5459.0k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   49%,   0 mins elapsed, rate=5612.0k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   58%,   0 mins elapsed, rate=5641.1k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   66%,   0 mins elapsed, rate=5752.2k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   74%,   0 mins elapsed, rate=5840.8k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   83%,   0 mins elapsed, rate=5906.4k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   91%,   0 mins elapsed, rate=5956.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || 3.1 GB of memory is needed for index building.                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Build the index...                                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||    8%,   0 mins elapsed, rate=873.2k bps/s                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   16%,   0 mins elapsed, rate=1324.9k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   24%,   0 mins elapsed, rate=1565.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   33%,   0 mins elapsed, rate=1777.0k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   41%,   0 mins elapsed, rate=1896.5k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   49%,   0 mins elapsed, rate=1989.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   58%,   0 mins elapsed, rate=2066.0k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   66%,   0 mins elapsed, rate=2126.6k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   74%,   0 mins elapsed, rate=2194.4k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   83%,   0 mins elapsed, rate=2240.0k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   91%,   0 mins elapsed, rate=2288.5k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Save current index block...                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 0.0% finished ]                                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 10.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 20.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 30.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 40.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 50.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 60.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 70.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 80.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 90.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 100.0% finished ]                                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Total running time: 0.4 minutes.                      ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                    Index target was successfully built.                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "target_1"</span>
<span class="r-in"><span class="va">readPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"reads.fastq"</span>,package <span class="op">=</span> <span class="st">"MetaScope"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">target_map</span> <span class="op">&lt;-</span> <span class="fu">align_target</span><span class="op">(</span><span class="va">readPath</span>, <span class="st">"target"</span>, project_name<span class="op">=</span><span class="st">"subread_target"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========     _____ _    _ ____  _____  ______          _____  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         =====         / ____| |  | |  _ \|  __ \|  ____|   /\   |  __ \ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           =====      | (___ | |  | | |_) | |__) | |__     /  \  | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ====      \___ \| |  | |  _ &lt;|  _  /|  __|   / /\ \ | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               ====    ____) | |__| | |_) | | \ \| |____ / ____ \| |__| |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========   |_____/ \____/|____/|_|  \_\______/_/    \_\_____/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Rsubread 2.8.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= setting ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Function      : Read alignment (DNA-Seq)                                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Input file    : reads.fastq                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Output file   : reads.target.bam (BAM)                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Index name    : target                                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                    ------------------------------------                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                               Threads : 8                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                          Phred offset : 33                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                             Min votes : 3 / 10                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                        Max mismatches : 3                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Max indel length : 5                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            Report multi-mapping reads : yes                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Max alignments per multi-mapping read : 16                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================ Running (11-Mar-2022 13:56:00, pid=120161) ================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the input reads.                                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || The input file contains base space reads.                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Initialise the memory objects.                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Estimate the mean read length.                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || WARNING  - The specified Phred score offset (33) seems incorrect.          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            ASCII values of the quality scores of read bases included in    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            the first 1499 reads were found to be within the range of       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            [50,50].                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Create the output BAM file.                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the index.                                                           ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Init the voting space.                                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Global environment is initialised.                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Load the 1-th index block...                                               ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || The index block has been loaded.                                           ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Start read mapping in chunk.                                               ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                           Completed successfully.                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\====================================    ====================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================   Summary =================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                 Total reads : 1,500                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Mapped : 903 (60.2%)                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||             Uniquely mapped : 698                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Multi-mapping : 205                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                    Unmapped : 597                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Indels : 42                                           ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                     WARNING : Phred offset (33) incorrect?                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                Running time : 0.7 minutes                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot rename file '/scratch/3276553.1.linga/Rtmpp8sDKo/temp_libpath1c89f2e042019/MetaScope/extdata/reads.target.bam' to 'subread_target.bam', reason 'Invalid cross-device link'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE! Alignments written to subread_target.bam</span>
<span class="r-in"><span class="va">target_map_sam</span> <span class="op">&lt;-</span> <span class="fu">Rsamtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rsamtools/man/scanBam.html" class="external-link">asSam</a></span><span class="op">(</span><span class="va">target_map</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Make and align to multiple reference libraries</span></span>
<span class="r-in"><span class="fu"><a href="mk_subread_index.html">mk_subread_index</a></span><span class="op">(</span><span class="st">'target.fasta'</span>, split <span class="op">=</span> <span class="fl">.02</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Library size is 0 GBs. Splitting the library into 2 separate components."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Printed 202 sequences to 2 genome files"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========     _____ _    _ ____  _____  ______          _____  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         =====         / ____| |  | |  _ \|  __ \|  ____|   /\   |  __ \ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           =====      | (___ | |  | | |_) | |__) | |__     /  \  | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ====      \___ \| |  | |  _ &lt;|  _  /|  __|   / /\ \ | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               ====    ____) | |__| | |_) | | \ \| |____ / ____ \| |__| |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========   |_____/ \____/|____/|_|  \_\______/_/    \_\_____/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Rsubread 2.8.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= setting ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                Index name : target_1                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Index space : base space                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Index split : no-split                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||          Repeat threshold : 100 repeats                                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||              Gapped index : no                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||       Free / total memory : 317.7GB / 376.4GB                              ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Input files : 1 file in total                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                             o target_1.fasta                               ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= Running ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the integrity of provided reference sequences ...                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || No format issues were found                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Scan uninformative subreads in reference sequences ...                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Estimate the index size...                                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||    8%,   0 mins elapsed, rate=2752.1k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   16%,   0 mins elapsed, rate=3985.3k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   24%,   0 mins elapsed, rate=4683.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   33%,   0 mins elapsed, rate=5129.6k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   49%,   0 mins elapsed, rate=5650.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   58%,   0 mins elapsed, rate=5839.6k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   66%,   0 mins elapsed, rate=5984.6k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   74%,   0 mins elapsed, rate=6105.3k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   83%,   0 mins elapsed, rate=6140.5k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   91%,   0 mins elapsed, rate=6184.5k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || 3.0 GB of memory is needed for index building.                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Build the index...                                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||    8%,   0 mins elapsed, rate=394.3k bps/s                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   16%,   0 mins elapsed, rate=698.5k bps/s                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   24%,   0 mins elapsed, rate=939.8k bps/s                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   33%,   0 mins elapsed, rate=1136.3k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   49%,   0 mins elapsed, rate=1445.6k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   58%,   0 mins elapsed, rate=1572.0k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   66%,   0 mins elapsed, rate=1676.5k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   74%,   0 mins elapsed, rate=1765.4k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   83%,   0 mins elapsed, rate=1842.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   91%,   0 mins elapsed, rate=1911.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Save current index block...                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 0.0% finished ]                                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 10.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 20.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 30.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 40.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 50.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 60.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 70.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 80.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 90.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 100.0% finished ]                                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Total running time: 0.2 minutes.                      ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                   Index target_1 was successfully built.                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========     _____ _    _ ____  _____  ______          _____  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         =====         / ____| |  | |  _ \|  __ \|  ____|   /\   |  __ \ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           =====      | (___ | |  | | |_) | |__) | |__     /  \  | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ====      \___ \| |  | |  _ &lt;|  _  /|  __|   / /\ \ | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               ====    ____) | |__| | |_) | | \ \| |____ / ____ \| |__| |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========   |_____/ \____/|____/|_|  \_\______/_/    \_\_____/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Rsubread 2.8.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= setting ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                Index name : target_2                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Index space : base space                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Index split : no-split                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||          Repeat threshold : 100 repeats                                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||              Gapped index : no                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||       Free / total memory : 317.9GB / 376.4GB                              ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Input files : 1 file in total                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                             o target_2.fasta                               ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= Running ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the integrity of provided reference sequences ...                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || No format issues were found                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Scan uninformative subreads in reference sequences ...                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || 2 uninformative subreads were found.                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || These subreads were excluded from index building.                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Estimate the index size...                                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||    8%,   0 mins elapsed, rate=3946.9k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   16%,   0 mins elapsed, rate=5062.1k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   33%,   0 mins elapsed, rate=5907.8k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   41%,   0 mins elapsed, rate=6108.0k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   49%,   0 mins elapsed, rate=6250.1k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   58%,   0 mins elapsed, rate=6354.3k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   66%,   0 mins elapsed, rate=6434.3k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   74%,   0 mins elapsed, rate=6490.1k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   83%,   0 mins elapsed, rate=6543.1k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   91%,   0 mins elapsed, rate=6587.8k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || 3.1 GB of memory is needed for index building.                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Build the index...                                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||    8%,   0 mins elapsed, rate=687.0k bps/s                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   16%,   0 mins elapsed, rate=1111.4k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   33%,   0 mins elapsed, rate=1620.5k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   41%,   0 mins elapsed, rate=1778.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   49%,   0 mins elapsed, rate=1902.8k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   58%,   0 mins elapsed, rate=2001.6k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   66%,   0 mins elapsed, rate=2082.7k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   74%,   0 mins elapsed, rate=2150.6k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   83%,   0 mins elapsed, rate=2211.4k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||   91%,   0 mins elapsed, rate=2260.4k bps/s                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Save current index block...                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 0.0% finished ]                                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 10.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 20.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 30.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 40.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 50.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 60.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 70.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 80.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 90.0% finished ]                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||  [ 100.0% finished ]                                                       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Total running time: 0.3 minutes.                      ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                   Index target_2 was successfully built.                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "target_1" "target_2"</span>
<span class="r-in"><span class="va">targLibs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"target_1"</span>, <span class="st">"target_2"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">readPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"reads.fastq"</span>,package <span class="op">=</span> <span class="st">"MetaScope"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">target_map</span> <span class="op">&lt;-</span> <span class="fu">align_target</span><span class="op">(</span><span class="va">readPath</span>, <span class="va">targLibs</span>, project_name <span class="op">=</span> <span class="st">"subread_target"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========     _____ _    _ ____  _____  ______          _____  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         =====         / ____| |  | |  _ \|  __ \|  ____|   /\   |  __ \ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           =====      | (___ | |  | | |_) | |__) | |__     /  \  | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ====      \___ \| |  | |  _ &lt;|  _  /|  __|   / /\ \ | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               ====    ____) | |__| | |_) | | \ \| |____ / ____ \| |__| |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========   |_____/ \____/|____/|_|  \_\______/_/    \_\_____/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Rsubread 2.8.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= setting ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Function      : Read alignment (DNA-Seq)                                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Input file    : reads.fastq                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Output file   : reads.target_1.bam (BAM)                                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Index name    : target_1                                                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                    ------------------------------------                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                               Threads : 8                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                          Phred offset : 33                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                             Min votes : 3 / 10                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                        Max mismatches : 3                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Max indel length : 5                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            Report multi-mapping reads : yes                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Max alignments per multi-mapping read : 16                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================ Running (11-Mar-2022 13:57:19, pid=120161) ================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the input reads.                                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || The input file contains base space reads.                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Initialise the memory objects.                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Estimate the mean read length.                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || WARNING  - The specified Phred score offset (33) seems incorrect.          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            ASCII values of the quality scores of read bases included in    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            the first 1499 reads were found to be within the range of       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            [50,50].                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Create the output BAM file.                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the index.                                                           ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Init the voting space.                                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Global environment is initialised.                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Load the 1-th index block...                                               ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || The index block has been loaded.                                           ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Start read mapping in chunk.                                               ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                           Completed successfully.                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\====================================    ====================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================   Summary =================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                 Total reads : 1,500                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Mapped : 892 (59.5%)                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||             Uniquely mapped : 750                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Multi-mapping : 142                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                    Unmapped : 608                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Indels : 31                                           ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                     WARNING : Phred offset (33) incorrect?                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                Running time : 0.7 minutes                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========     _____ _    _ ____  _____  ______          _____  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         =====         / ____| |  | |  _ \|  __ \|  ____|   /\   |  __ \ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           =====      | (___ | |  | | |_) | |__) | |__     /  \  | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ====      \___ \| |  | |  _ &lt;|  _  /|  __|   / /\ \ | |  | |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               ====    ____) | |__| | |_) | | \ \| |____ / ____ \| |__| |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ==========   |_____/ \____/|____/|_|  \_\______/_/    \_\_____/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Rsubread 2.8.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================= setting ==================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Function      : Read alignment (DNA-Seq)                                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Input file    : reads.fastq                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Output file   : reads.target_2.bam (BAM)                                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Index name    : target_2                                                   ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                    ------------------------------------                    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                               Threads : 8                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                          Phred offset : 33                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                             Min votes : 3 / 10                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                        Max mismatches : 3                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Max indel length : 5                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            Report multi-mapping reads : yes                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Max alignments per multi-mapping read : 16                                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================ Running (11-Mar-2022 13:57:59, pid=120161) ================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the input reads.                                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || The input file contains base space reads.                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Initialise the memory objects.                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Estimate the mean read length.                                             ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || WARNING  - The specified Phred score offset (33) seems incorrect.          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            ASCII values of the quality scores of read bases included in    ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            the first 1499 reads were found to be within the range of       ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||            [50,50].                                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Create the output BAM file.                                                ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Check the index.                                                           ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Init the voting space.                                                     ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Global environment is initialised.                                         ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Load the 1-th index block...                                               ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || The index block has been loaded.                                           ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> || Start read mapping in chunk.                                               ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                           Completed successfully.                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\====================================    ====================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> //================================   Summary =================================\\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                 Total reads : 1,500                                        ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Mapped : 599 (39.9%)                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||             Uniquely mapped : 140                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||               Multi-mapping : 459                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                    Unmapped : 901                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                      Indels : 108                                          ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                     WARNING : Phred offset (33) incorrect?                 ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                Running time : 0.6 minutes                                  ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ||                                                                            ||</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \\============================================================================//</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Merging the bam files into subread_target.bam"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Making a combined header file: subread_target_header.sam"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Merging and sorting .bam files"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE! Alignments written to subread_target.bam</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Site created by Aubrey Odom-Mabey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

